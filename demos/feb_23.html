<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>

<body>
  <canvas width="600" height="430"></canvas>

  <script>
    const canvas = document.querySelector('canvas');
    const ctx = canvas.getContext('2d');

    const width = canvas.width;
    const height = canvas.height;

    const rect = ({
      x, y,
      width, height,
      style: {
        fill: fillStyle,
        stroke: strokeStyle,
        strokeWidth: lineWidth
      }
    }) => {
      ctx.save();
      ctx.beginPath();

      ctx.rect(x, y, width, height);

      ctx.fillStyle = fillStyle;
      ctx.strokeStyle = strokeStyle;
      ctx.lineWidth = lineWidth;
      ctx.fill();
      ctx.stroke();
      ctx.restore();
    }

    const drawRotationRect = (x, y, angle) => {
      ctx.save();
      // fix rotation rotation
      let rectWidth = 200;
      let rectHeight = 100;

      ctx.translate(x + rectWidth / 2, y + rectHeight / 2);
      ctx.rotate(angle * Math.PI / 180);
      ctx.translate(-(x + rectWidth / 2), -(y + rectHeight / 2));

      rect({
        x: x, y: y,
        width: rectWidth, height: rectHeight,
        style: {
          fill: 'red',
          stroke: 'green',
          strokeWidth: 3
        }
      });

      ctx.restore();
    }

    let myRects = [
      {x: 100, y: 100, rotation: 0, rateOfRotation: 5},
      {x: 200, y: 50, rotation: 0, rateOfRotation: 2},
      {x: 50, y: 50, rotation: 0, rateOfRotation: 3}
    ]

    let rotation = 0;
    let rotationPerSecond = 10;

    let lastTs = 0;
    const step = (ts) => {
      const deltaT = ts - lastTs; // How long each frame takes
      const frameRate = deltaT / 1000;  // Per second

      rotation += frameRate * rotationPerSecond;

      ctx.clearRect(0, 0, width, height);

      ctx.save();
      
      for () {
        thisRect.rotation += thisRect.rateOfRotation * frameRate;
      }

      for (let i = 0; i < myRects.length; i++) {
        const thisRect = myRects[i];

        drawRotationRect(
          thisRect.x,
          thisRect.y,
          thisRect.rotation
        );
      }
      
      lastTs = ts;
      ctx.restore();
      requestAnimationFrame(step);
    };
    requestAnimationFrame(step);






  </script>
</body>

</html>